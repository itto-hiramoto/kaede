import std.ffi.sync

use std.ffi.sync.*

pub struct Mutex {
    ptr: *i8,
}

impl Mutex {
    pub fn new(): mut Mutex {
        return Mutex { ptr: kaede_mutex_new() }
    }

    pub fn lock(mut self) {
        kaede_mutex_lock(self.ptr)
    }

    pub fn unlock(mut self) {
        kaede_mutex_unlock(self.ptr)
    }
}

pub struct WaitGroup {
    ptr: *i8,
}

impl WaitGroup {
    pub fn new(): mut WaitGroup {
        return WaitGroup { ptr: kaede_wg_new() }
    }

    pub fn add(mut self, delta: i32) {
        kaede_wg_add(self.ptr, delta)
    }

    pub fn done(mut self) {
        kaede_wg_done(self.ptr)
    }

    pub fn wait(self) {
        kaede_wg_wait(self.ptr)
    }
}
